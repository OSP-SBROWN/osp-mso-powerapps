# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  HierMan:
    Properties:
      OnVisible: |-
        =// Temporarily disabled - add helper functions to App first
        // If(
        //     IsEmpty(HierMan_Versions),
        //     Func_HierMan_LoadVersions(),
        //     If(
        //         IsBlank(HierMan_SelectedVersion) && CountRows(HierMan_Versions) > 0,
        //         Func_HierMan_SelectVersion(First(HierMan_Versions).ID)
        //     )
        // )
        false
    Children:
      - ScreenContainer1_1:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =App.Theme.Colors.Darker60
            Height: =Parent.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =8
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =8
            PaddingTop: =8
            Width: =Parent.Width
          Children:
            - HeaderContainer1_1:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  Fill: =App.Theme.Colors.Primary
                  FillPortions: =0
                  Height: =75
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =15
                Children:
                  - Image3_9:
                      Control: Image@2.2.3
                      Properties:
                        Height: =Parent.Height
                        HoverFill: =App.Theme.Colors.Primary
                        Image: =Func_IconSvg("Menu",App.Theme.Colors.Darker60)
                        ImagePosition: =ImagePosition.Fill
                        OnSelect: =Set(Vis_Nav,true)
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Tooltip: ="Refresh Reports List"
                        Width: =Self.Height
                        X: =808
                  - TextCanvas1_1:
                      Control: Text@0.0.51
                      Properties:
                        FillPortions: =1
                        Height: =Parent.Height*0.7
                        Size: =Self.Height*0.7
                        Text: =If(IsBlank(HierMan_SelectedVersion),"Hierarchy Management","Hierarchy Management · " & HierMan_SelectedVersion.Name)
                        VerticalAlign: =VerticalAlign.Middle
            - MainContainer1_1:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =8
                Children:
                  - HierarchyListContainer:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Stretch
                        Fill: =App.Theme.Colors.Lighter50
                        FillPortions: =1
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =12
                        PaddingBottom: =16
                        PaddingLeft: =16
                        PaddingRight: =16
                        PaddingTop: =16
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                      Children:
                        - HierarchyListHeader:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =App.Theme.Colors.Primary
                              FillPortions: =0
                              Height: =44
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutGap: =10
                              PaddingLeft: =12
                              PaddingRight: =12
                              RadiusBottomLeft: =6
                              RadiusBottomRight: =6
                              RadiusTopLeft: =6
                              RadiusTopRight: =6
                            Children:
                              - HierarchyListLabel:
                                  Control: Text@0.0.51
                                  Properties:
                                    FillPortions: =1
                                    Height: =Parent.Height
                                    Size: =16
                                    Text: ="Hierarchy Versions"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - HierarchyRefreshButton:
                                  Control: Image@2.2.3
                                  Properties:
                                    Height: =Parent.Height-8
                                    HoverFill: =App.Theme.Colors.Primary
                                    Image: =Func_IconSvg("Refresh",App.Theme.Colors.Darker60)
                                    ImagePosition: =ImagePosition.Fill
                                    OnSelect: =false // Func_HierMan_LoadVersions()
                                    RadiusBottomLeft: =6
                                    RadiusBottomRight: =6
                                    RadiusTopLeft: =6
                                    RadiusTopRight: =6
                                    Tooltip: ="Reload versions"
                                    Width: =Parent.Height-8
                        - HierarchyVersionGallery:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              FillPortions: =1
                              Items: =HierMan_Versions
                              OnSelect: =false // Func_HierMan_SelectVersion(ThisItem.ID)
                              TemplateFill: =Color.Transparent
                              TemplatePadding: =0
                              TemplateSize: =72
                            Children:
                              - HierarchyVersionCard:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    Fill: =If(ThisItem.ID = Coalesce(HierMan_SelectedVersion.ID, -1), App.Theme.Colors.Lighter40, Color.Transparent)
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutGap: =6
                                    PaddingBottom: =12
                                    PaddingLeft: =12
                                    PaddingRight: =12
                                    PaddingTop: =12
                                    RadiusBottomLeft: =6
                                    RadiusBottomRight: =6
                                    RadiusTopLeft: =6
                                    RadiusTopRight: =6
                                  Children:
                                    - HierarchyVersionName:
                                        Control: Text@0.0.51
                                        Properties:
                                          Height: =28
                                          Size: =16
                                          Text: =Coalesce(ThisItem.Name,"(No name)")
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Semibold
                                    - HierarchyVersionStatus:
                                        Control: Text@0.0.51
                                        Properties:
                                          Fill: =App.Theme.Colors.Lighter30
                                          Height: =26
                                          PaddingLeft: =12
                                          PaddingRight: =12
                                          RadiusBottomLeft: =13
                                          RadiusBottomRight: =13
                                          RadiusTopLeft: =13
                                          RadiusTopRight: =13
                                          Text: =Upper(Coalesce(ThisItem.Status,"UNKNOWN"))
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Semibold
                                    - HierarchyVersionMeta:
                                        Control: Text@0.0.51
                                        Properties:
                                          Height: =20
                                          Size: =12
                                          Text: =If(IsBlank(ThisItem.CreatedDate),"","Created " & Text(ThisItem.CreatedDate, "[$-en-US]mmm d, yyyy") & " · " & Coalesce(ThisItem.CreatedBy, "Unknown"))
                                          VerticalAlign: =VerticalAlign.Middle
                  - HierarchyDetailContainer:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Stretch
                        Fill: =App.Theme.Colors.Lighter50
                        FillPortions: =2
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =12
                        PaddingBottom: =16
                        PaddingLeft: =16
                        PaddingRight: =16
                        PaddingTop: =16
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                      Children:
                        - HierarchyDetailHeader:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =App.Theme.Colors.Primary
                              FillPortions: =0
                              Height: =44
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutGap: =10
                              PaddingLeft: =12
                              PaddingRight: =12
                              RadiusBottomLeft: =6
                              RadiusBottomRight: =6
                              RadiusTopLeft: =6
                              RadiusTopRight: =6
                            Children:
                              - HierarchyDetailLabel:
                                  Control: Text@0.0.51
                                  Properties:
                                    FillPortions: =1
                                    Height: =Parent.Height
                                    Size: =16
                                    Text: =If(IsBlank(HierMan_SelectedVersion),"Version Overview","Version Overview · " & HierMan_SelectedVersion.Name)
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - HierarchyDetailRefresh:
                                  Control: Image@2.2.3
                                  Properties:
                                    DisplayMode: =If(IsBlank(HierMan_SelectedVersion), DisplayMode.Disabled, DisplayMode.Edit)
                                    Height: =Parent.Height-8
                                    HoverFill: =App.Theme.Colors.Primary
                                    Image: =Func_IconSvg("Refresh",App.Theme.Colors.Darker60)
                                    ImagePosition: =ImagePosition.Fill
                                    OnSelect: =If(Not(IsBlank(HierMan_SelectedVersion)), Func_HierMan_LoadVersionDetails(HierMan_SelectedVersion.ID))
                                    RadiusBottomLeft: =6
                                    RadiusBottomRight: =6
                                    RadiusTopLeft: =6
                                    RadiusTopRight: =6
                                    Tooltip: ="Reload selected version detail"
                                    Width: =Parent.Height-8
                        - HierarchySummaryCard:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =App.Theme.Colors.Lighter60
                              FillPortions: =0
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =4
                              PaddingBottom: =12
                              PaddingLeft: =12
                              PaddingRight: =12
                              PaddingTop: =12
                              RadiusBottomLeft: =6
                              RadiusBottomRight: =6
                              RadiusTopLeft: =6
                              RadiusTopRight: =6
                            Children:
                              - HierarchySummaryTitle:
                                  Control: Text@0.0.51
                                  Properties:
                                    Size: =16
                                    Text: =If(IsBlank(HierMan_SelectedVersion), "Select a hierarchy version to get started", HierMan_SelectedVersion.Name)
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - HierarchySummaryMeta:
                                  Control: Text@0.0.51
                                  Properties:
                                    Height: =24
                                    Size: =12
                                    Text: =If(IsBlank(HierMan_SelectedVersion), "", "Status: " & Coalesce(HierMan_SelectedVersion.Status, "Unknown") & " · Created " & Text(HierMan_SelectedVersion.CreatedDate, "[$-en-US]mmm d, yyyy") & " by " & Coalesce(HierMan_SelectedVersion.CreatedBy, "Unknown"))
                                    VerticalAlign: =VerticalAlign.Middle
                              - HierarchySummaryCounts:
                                  Control: Text@0.0.51
                                  Properties:
                                    Height: =24
                                    Size: =12
                                    Text: =If(IsBlank(HierMan_SelectedVersion), "", "Lines: " & CountRows(HierMan_Detail) & " · Level 1: " & CountRows(HierMan_H1) & " · Level 2: " & CountRows(HierMan_H2) & " · Level 3: " & CountRows(HierMan_H3))
                                    VerticalAlign: =VerticalAlign.Middle
                        - HierarchyDetailEmptyState:
                            Control: Text@0.0.51
                            Properties:
                              FontColor: =App.Theme.Colors.PrimaryForeground
                              Size: =14
                              Text: ="No hierarchy detail to display."
                              VerticalAlign: =VerticalAlign.Middle
                              Visible: =Not(IsBlank(HierMan_SelectedVersion)) && CountRows(HierMan_Detail) = 0
                        - HierarchyDetailGallery:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              FillPortions: =1
                              Items: =HierMan_Detail
                              TemplateFill: =Color.Transparent
                              TemplatePadding: =8
                              TemplateSize: =76
                              Visible: =CountRows(HierMan_Detail) > 0
                            Children:
                              - HierarchyDetailCard:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    Fill: =If(Mod(Coalesce(ThisItem.FlowNumber,0),2)=0, App.Theme.Colors.Lighter40, App.Theme.Colors.Lighter50)
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutGap: =6
                                    PaddingBottom: =8
                                    PaddingLeft: =8
                                    PaddingRight: =8
                                    PaddingTop: =8
                                    RadiusBottomLeft: =4
                                    RadiusBottomRight: =4
                                    RadiusTopLeft: =4
                                    RadiusTopRight: =4
                                  Children:
                                    - HierarchyDetailPath:
                                        Control: Text@0.0.51
                                        Properties:
                                          Height: =24
                                          Size: =14
                                          Text: =Concatenate(ThisItem.Hierarchy1_Name, " › ", ThisItem.Hierarchy2_Name, " › ", ThisItem.Hierarchy3_Name)
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Semibold
                                    - HierarchyDetailInfo:
                                        Control: Text@0.0.51
                                        Properties:
                                          Height: =20
                                          Size: =12
                                          Text: ="Trend: " & Coalesce(ThisItem.Trend, "-") & " · Min Bays: " & Coalesce(ThisItem.MinBays, "-") & " · Max Bays: " & Coalesce(ThisItem.MaxBays, "-")
                                          VerticalAlign: =VerticalAlign.Middle
                                    - HierarchyDetailFlags:
                                        Control: Text@0.0.51
                                        Properties:
                                          Height: =20
                                          FontColor: =If(Coalesce(ThisItem.Exclude_From_Analysis,0)=1, Color.IndianRed, App.Theme.Colors.PrimaryForeground)
                                          Size: =12
                                          Text: =If(Coalesce(ThisItem.Exclude_From_Analysis,0)=1, "Excluded from analysis", "Included in analysis") & " · Flow #" & Coalesce(ThisItem.FlowNumber, "-")
                                          VerticalAlign: =VerticalAlign.Middle
            - FooterContainer1_1:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  Fill: =RGBA(255, 255, 255, 1)
                  FillPortions: =0
                  Height: =40
                  LayoutDirection: =LayoutDirection.Horizontal
                Children:
                  - StatusBar_3:
                      Control: CanvasComponent
                      ComponentName: StatusBar
                      Properties:
                        Fill: =App.Theme.Colors.Lighter30
                        Height: =StatusBar_3.Ht
                        Ht: =Parent.Height
                        Wd: =Parent.Width
                        Width: =StatusBar_3.Wd
      - NavMenu_2:
          Control: CanvasComponent
          ComponentName: NavMenu
          Properties:
            Fill: =RGBA(0,0,0,0.5)
            Height: =App.DesignHeight
            Visible: =Vis_Nav
            Width: =App.DesignWidth
